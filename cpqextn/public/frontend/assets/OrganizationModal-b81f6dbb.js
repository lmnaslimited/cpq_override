import{F as P}from"./Fields-6a34413d.js";import{_ as K}from"./AddressModal-ced65781.js";import{E as X}from"./EditIcon-a130850d.js";import{_ as B,b as i,c as u,e as t,m as Y,v as ee,i as b,l as d,j as O,B as D,D as V,x as ae,I as h,k as ne,r as N,d as g,w as E,t as Z,u as w,g as z,p as I,F as $,f as F,G as te,C as le,L as oe,z as se,A as j}from"./index-d057f33a.js";import{O as ie}from"./OrganizationsIcon-321405d1.js";import{u as re,e as ue}from"./UserAvatar-e49c5291.js";const ce={},de={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-circle-dollar-sign"};function ve(v,s){return i(),u("svg",de,s[0]||(s[0]=[t("circle",{cx:"12",cy:"12",r:"10"},null,-1),t("path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"},null,-1),t("path",{d:"M12 18V6"},null,-1)]))}const me=B(ce,[["render",ve]]),fe={},_e={width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function pe(v,s){return i(),u("svg",_e,s[0]||(s[0]=[t("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.02062 7.49896C2.49506 7.49716 2.97742 7.4933 3.47006 7.48935C3.94277 7.48556 4.42495 7.48169 4.9187 7.47951C4.97589 6.3862 5.14998 5.23014 5.51484 4.17085C5.76241 3.45208 6.1023 2.76557 6.56226 2.17336C4.09972 2.77895 2.23508 4.90491 2.02062 7.49896ZM8 2.1204C7.29452 2.69277 6.79592 3.52219 6.46032 4.49652C6.13931 5.4285 5.97681 6.46734 5.92025 7.4779C6.5896 7.47899 7.28127 7.485 8 7.49989C8.7546 7.48425 9.43077 7.47841 10.0797 7.47777C10.0232 6.46725 9.86068 5.42846 9.53968 4.49651C9.20408 3.52219 8.70548 2.69277 8 2.1204ZM10.0822 8.47771C10.0279 9.50221 9.8654 10.5578 9.53968 11.5035C9.20409 12.4778 8.70548 13.3072 8.00001 13.8796C7.29453 13.3072 6.79592 12.4778 6.46032 11.5035C6.13462 10.5579 5.9721 9.5023 5.91784 8.47784C6.58355 8.47892 7.27164 8.48494 7.98959 8.49989C7.99653 8.50004 8.00347 8.50004 8.01042 8.49989C8.76493 8.48417 9.43715 8.47833 10.0822 8.47771ZM4.91661 8.47951C4.43411 8.48168 3.962 8.48548 3.49714 8.48922C2.99784 8.49323 2.50691 8.49718 2.02045 8.49899C2.2341 11.094 4.09907 13.2209 6.56227 13.8266C6.1023 13.2344 5.76241 12.5479 5.51484 11.8291C5.14541 10.7566 4.97157 9.58487 4.91661 8.47951ZM9.43774 13.8266C9.89771 13.2344 10.2376 12.5479 10.4852 11.8291C10.8545 10.7569 11.0283 9.58549 11.0834 8.48039C11.4269 8.48234 11.771 8.48511 12.1244 8.48796C12.7045 8.49264 13.3098 8.49752 13.9795 8.4993C13.7658 11.0941 11.9008 13.2209 9.43774 13.8266ZM13.9794 7.49928C13.3241 7.49751 12.7264 7.49271 12.1508 7.48809C11.7885 7.48518 11.435 7.48234 11.0814 7.48037C11.0242 6.38681 10.8501 5.23042 10.4852 4.17085C10.2376 3.45208 9.89771 2.76557 9.43774 2.17336C11.9004 2.77897 13.7651 4.90509 13.9794 7.49928ZM1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8Z",fill:"currentColor"},null,-1)]))}const ge=B(fe,[["render",pe]]),Ce={},ye={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"lucide lucide-land-plot"};function he(v,s){return i(),u("svg",ye,s[0]||(s[0]=[t("path",{d:"m12 8 6-3-6-3v10"},null,-1),t("path",{d:"m8 11.99-5.5 3.14a1 1 0 0 0 0 1.74l8.5 4.86a2 2 0 0 0 2 0l8.5-4.86a1 1 0 0 0 0-1.74L16 12"},null,-1),t("path",{d:"m6.49 12.85 11.02 6.3"},null,-1),t("path",{d:"M17.51 12.85 6.5 19.15"},null,-1)]))}const we=B(Ce,[["render",he]]),ze={class:"bg-white px-4 pb-6 pt-5 sm:px-6"},Me={class:"mb-5 flex items-center justify-between"},ke={class:"text-2xl font-semibold leading-6 text-gray-900"},xe={class:"flex items-center gap-1"},be={key:0,class:"flex flex-col gap-3.5"},Oe={class:"grid w-7 place-content-center"},Ve={key:0,class:"px-4 pb-7 pt-4 sm:px-6"},Ee={class:"space-y-2"},Ne={__name:"OrganizationModal",props:Y({options:{type:Object,default:{redirect:!0,detailMode:!1,afterInsert:()=>{}}}},{modelValue:{},modelModifiers:{},organization:{},organizationModifiers:{},quickEntry:{},quickEntryModifiers:{}}),emits:["update:modelValue","update:organization","update:quickEntry"],setup(v){const s=v,{isManager:q}=re(),U=ee(),m=b(v,"modelValue"),M=b(v,"organization"),_=d(!1);d(null);const c=d(!1),p=d(!1);let f=d({}),l=d({organization_name:"",website:"",annual_revenue:"",no_of_employees:"1-10",industry:""});const C=d(!1);let y=d({});async function A(){const a={...y.value},e={...l.value},o=a.organization_name!==e.organization_name;delete a.organization_name,delete e.organization_name;const r=JSON.stringify(a)!==JSON.stringify(e),n=e;if(!o&&!r){m.value=!1;return}let x;_.value=!0,o&&(x=await L()),r&&(x=await Q(n)),R({name:x},o)}async function L(){var e;const a=await h("frappe.client.rename_doc",{doctype:"CRM Organization",old_name:(e=y.value)==null?void 0:e.organization_name,new_name:l.value.organization_name});return _.value=!1,a}async function Q(a){const e=await h("frappe.client.set_value",{doctype:"CRM Organization",name:l.value.name,fieldname:a});return _.value=!1,e.name}async function T(){const a=await h("frappe.client.insert",{doc:{doctype:"CRM Organization",...l.value}});_.value=!1,a.name&&(se("organization_created"),R(a))}function R(a,e=!1){var o,r;a.name&&(s.options.redirect||e)?U.push({name:"Organization",params:{organizationId:a.name}}):(r=(o=M.value).reload)==null||r.call(o),m.value=!1,s.options.afterInsert&&s.options.afterInsert(a)}const k=O(()=>{let a=p.value?__(l.value.organization_name):__("New Organization"),e=c.value?"":"xl",o=c.value?[]:[{label:p.value?__("Save"):__("Create"),variant:"solid",onClick:()=>p.value?A():T()}];return{title:a,size:e,actions:o}}),J=O(()=>[{icon:ie,name:"organization_name",value:l.value.organization_name},{icon:ge,name:"website",value:l.value.website},{icon:we,name:"territory",value:l.value.territory},{icon:me,name:"annual_revenue",value:ue(l.value.annual_revenue,l.value.currency)},{icon:D(V,{name:"hash",class:"h-4 w-4"}),name:"no_of_employees",value:l.value.no_of_employees},{icon:D(V,{name:"briefcase",class:"h-4 w-4"}),name:"industry",value:l.value.industry}].filter(e=>e.value)),W=ae({url:"crm.fcrm.doctype.crm_fields_layout.crm_fields_layout.get_fields_layout",cache:["quickEntryFields","CRM Organization"],params:{doctype:"CRM Organization",type:"Quick Entry"},auto:!0}),S=O(()=>{let a=W.data||[];return a.length?(a.forEach(e=>{e.fields.forEach(o=>{o.name=="address"&&(o.create=(r,n)=>{l.value.address=r,f.value={},C.value=!0,n()},o.edit=async r=>{f.value=await h("frappe.client.get",{doctype:"Address",name:r}),C.value=!0})})}),a):[]});ne(()=>m.value,a=>{a&&(p.value=!1,c.value=s.options.detailMode,j(()=>{var e;y.value=((e=M.value)==null?void 0:e.doc)||M.value||{},l.value={...y.value},l.value.name&&(p.value=!0)}))});const G=b(v,"quickEntry");function H(){G.value=!0,j(()=>{m.value=!1})}return(a,e)=>{const o=N("Button"),r=N("Dialog");return i(),u($,null,[g(r,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=n=>m.value=n),options:k.value},{body:E(()=>[t("div",ze,[t("div",Me,[t("div",null,[t("h3",ke,Z(a.__(k.value.title)||a.__("Untitled")),1)]),t("div",xe,[w(q)()||c.value?(i(),z(o,{key:0,variant:"ghost",class:"w-7",onClick:e[0]||(e[0]=n=>c.value?c.value=!1:H())},{default:E(()=>[g(X,{class:"h-4 w-4"})]),_:1})):I("",!0),g(o,{variant:"ghost",class:"w-7",onClick:e[1]||(e[1]=n=>m.value=!1)},{default:E(()=>[g(w(V),{name:"x",class:"h-4 w-4"})]),_:1})])]),t("div",null,[c.value?(i(),u("div",be,[(i(!0),u($,null,F(J.value,n=>(i(),u("div",{class:"flex h-7 items-center gap-2 text-base text-gray-800",key:n.name},[t("div",Oe,[(i(),z(te(n.icon)))]),t("div",null,Z(n.value),1)]))),128))])):S.value?(i(),z(P,{key:1,sections:S.value,data:w(l)},null,8,["sections","data"])):I("",!0)])]),c.value?I("",!0):(i(),u("div",Ve,[t("div",Ee,[(i(!0),u($,null,F(k.value.actions,n=>(i(),z(o,le({class:"w-full",key:n.label,ref_for:!0},n,{label:a.__(n.label),loading:_.value}),null,16,["label","loading"]))),128))])]))]),_:1},8,["modelValue","options"]),g(K,{modelValue:C.value,"onUpdate:modelValue":e[3]||(e[3]=n=>C.value=n),address:w(f),"onUpdate:address":e[4]||(e[4]=n=>oe(f)?f.value=n:f=n)},null,8,["modelValue","address"])],64)}}};export{me as M,we as T,ge as W,Ne as _};
//# sourceMappingURL=OrganizationModal-b81f6dbb.js.map
