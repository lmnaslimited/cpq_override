{"version":3,"file":"SectionFieldCpq-942892b4.js","sources":["../../../../frontend/src/components/SectionFieldCpq.vue"],"sourcesContent":["<template>\n    <SectionFields \n      :fields=\"fields\" \n      :isLastSection=\"isLastSection\" \n      >\n      <template #children=\"{ fields, data, emit }\">\n      <div v-for=\"field in fields\"> \n      <div v-if=\"field.children && field.children.length > 0\" class=\"flex flex-col mt-2\">\n        <div v-for=\"child in field.children\" :key=\"child.name\" class=\"flex items-center justify-between gap-2 px-3\">\n          <Tooltip :text=\"__(child.label)\" :hoverDelay=\"1\">\n            <div class=\"flex items-center\">\n              <span class=\"sm:w-[106px] w-36 shrink-0 truncate text-sm text-gray-600\">\n                {{ __(child.label) }}\n              </span>\n            </div>\n          </Tooltip>\n          <div class=\"flex-1\">\n            <FormControl\n                v-if=\"child.type === 'select'\"\n                class=\"form-control\"\n                type=\"select\" \n                :options=\"child.options\"\n                v-model=\"child.value\"\n                :placeholder=\"child.placeholder\"\n                :debounce=\"500\"\n                @change=\"updateResource(child.doctype, child.parent, child.label, $event.target.value, data.doctype)\"\n              />\n              <FormControl\n                v-else\n                class=\"form-control\"\n                type=\"text\" \n                v-model=\"child.value\"\n                :placeholder=\"child.placeholder\"\n                :debounce=\"500\"\n                @change=\"handleInputChange(child.doctype, child.parent, child.label, $event.target.value, data.doctype)\"\n              />\n            </div>\n        </div>\n      </div>\n      </div>\n    </template>\n    </SectionFields>\n  </template>\n  \n  <script setup>\n  import SectionFields from '@/components/SectionFields.vue'\n  import { Tooltip, createResource} from 'frappe-ui'\n  import { capture } from '@/telemetry'\n  import { createToast } from '@/utils'\n  const props = defineProps({\n  fields: {\n      type: Object,\n      },\n      isLastSection: {\n          type: Boolean,\n          default: false,\n      },\n      })\n\n let timeout = null\n\n// Handle input change and debounce the update call\nconst handleInputChange = (childDoctype, parentDocName, targetField, newValue, sourceDoctype) => {\n  clearTimeout(timeout)\n  timeout = setTimeout(() => {\n    updateResource(childDoctype, parentDocName, targetField, newValue, sourceDoctype)\n  }, 500)\n}\n\n  // Parameters:\n  // - childDoctype: The name of the child doctype to update.\n  // - parentDocName: The name of the parent document to which the child belongs.\n  // - targetField: The field in the child doctype to update.\n  // - newValue: The new value to assign to the target field.\n  // - sourceDoctype: The source doctype from which data is being updated.\n  const updateResource = (childDoctype, parentDocName, targetField, newValue, sourceDoctype) => {\n    \n    createResource({\n      url: 'crm.api.docCpq.update_child_table',\n      method: 'PUT',\n      params: {\n        child_doctype : childDoctype,\n        parent_docName : parentDocName,\n        target_field : targetField,\n        new_value : newValue,\n      },\n      debounce: 500,\n      onSuccess(data) {\n        capture(`${sourceDoctype}_updated`);\n         createToast({\n            title: __(`${sourceDoctype} Updated`),\n            icon: 'check',\n            iconClasses: 'text-green-600',\n          })\n        \n      },\n      onError(error) {\n        console.error(\"Error updating resource:\", error);\n      },\n    }).submit();\n  };\n\n  \n  </script>\n  \n  <style scoped>\n .form-control {\n  margin: 2px;\n}\n  </style>\n  "],"names":["timeout","handleInputChange","childDoctype","parentDocName","targetField","newValue","sourceDoctype","updateResource","createResource","data","capture","createToast","error"],"mappings":"ggBA2DC,IAAIA,EAAU,KAGf,MAAMC,EAAoB,CAACC,EAAcC,EAAeC,EAAaC,EAAUC,IAAkB,CAC/F,aAAaN,CAAO,EACpBA,EAAU,WAAW,IAAM,CACzBO,EAAeL,EAAcC,EAAeC,EAAaC,EAAUC,CAAa,CACjF,EAAE,GAAG,CACR,EAQQC,EAAiB,CAACL,EAAcC,EAAeC,EAAaC,EAAUC,IAAkB,CAE5FE,EAAe,CACb,IAAK,oCACL,OAAQ,MACR,OAAQ,CACN,cAAgBN,EAChB,eAAiBC,EACjB,aAAeC,EACf,UAAYC,CACb,EACD,SAAU,IACV,UAAUI,EAAM,CACdC,EAAQ,GAAGJ,CAAa,UAAU,EACjCK,EAAY,CACT,MAAO,GAAG,GAAGL,CAAa,UAAU,EACpC,KAAM,QACN,YAAa,gBACzB,CAAW,CAEJ,EACD,QAAQM,EAAO,CACb,QAAQ,MAAM,2BAA4BA,CAAK,CAChD,CACP,CAAK,EAAE,OAAM,CACb"}